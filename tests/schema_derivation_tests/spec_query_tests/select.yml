catalog_schema:
  {
    'mydb': {
      'foo': {
        'bsonType': 'object',
        'additionalProperties': true,
      }
    }
  }

tests:
  - description: simple star correctness test
    current_db: mydb
    query: "SELECT * FROM foo AS f"
    result:
     - {'f': {'_id': 0, 'a': 1, 'b': 1}}
     - {'f': {'_id': 1, 'a': 2, 'b': 2}}

  - description: simple document correctness test
    current_db: mydb
    query: "SELECT VALUE {'a': a, 'b': b} FROM foo AS foo"
    result:
      - {'': {'a': 1, 'b': 1}}
      - {'': {'a': 2, 'b': 2}}

  - description: simple sub-star correctness test
    current_db: mydb
    query: "SELECT VALUE f.* FROM foo AS f"
    result:
     - {'f': {'_id': 0, 'a': 1, 'b': 1}}
     - {'f': {'_id': 1, 'a': 2, 'b': 2}}

  - description: correctness test for mixed sub-star and document
    current_db: mydb
    query: "SELECT VALUES {'a': foo.a}, foo.* FROM foo AS foo"
    result:
      - {'foo': {'_id': 0, 'a': 1, 'b': 1}, '': {'a': 1}}
      - {'foo': {'_id': 1, 'a': 2, 'b': 2}, '': {'a': 2}}

  - description: SELECT VALUES may create unmaterializable binding tuples
    current_db: mydb
    query: "SELECT VALUES {'a': a.a}, a.* FROM foo AS a"
    result:
      - {'a': {'_id': 0, 'a': 1, 'b': 1}, '': {'a': 1}}
      - {'a': {'_id': 1, 'a': 2, 'b': 2}, '': {'a': 2}}
