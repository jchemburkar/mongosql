catalog_schema:
  {
    "foo": {
      "bar": {
        "bsonType": "object",
        "additionalProperties": true
      },
      "bar_schema": {
        "bsonType": "object",
        "required": [ '_id', 'v1' ],
        "additionalProperties": false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "v1": {
            "anyOf": [
              { "bsonType": "string" },
              { "bsonType": "int" },
              { "bsonType": !!str "null" }
            ]
          },
        }
      }
    }
  }

tests:
  - description: correctness test for type assertion in schema mode
    current_db: "foo"
    query: "SELECT v1::!INT AS v1 FROM bar_schema"
    result:
      - {'': {v1: "abc"}}
      - {'': {v1: {"$numberInt": "2"}}}
      - {'': {v1: null}}

  - description: correctness test for type assertion in schema-less mode, target type can be any
    current_db: "foo"
    query: "SELECT v1::!DOUBLE AS v1 FROM bar"
    result:
      - {'': {v1: "abc"}}
      - {'': {v1: {"$numberInt": "2"}}}
      - {'': {v1: null}}

